---
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{attribution.Rmd}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---
# Demonstration of package

```{r, echo = TRUE, eval = TRUE, message = TRUE}
library(kilde)
df <- clean_data(country = 4)
inits <- function() {
    list(g0 = rep(1, df$ns), 
         pmuta = structure(.Data = rep(0.5, df$ns * 7), 
                           .Dim = c(df$ns, 7)), 
         h0=structure(.Data=rep(1, df$ns * df$ns), 
                      .Dim=c(df$ns, df$ns)))
}
parameters <- c("qASP", "phi", "etaASP")
res <- run_model(data = df, 
                  inits = inits, 
                 parameters = parameters)
par(mfrow=c(df$ns, 1))
plotrows <- ceiling(df$ns ^ 0.5)
plotcols <- ceiling(df$ns / plotrows)
par(mfrow=c(plotrows, plotcols))
for(i in 1:df$ns){
    plot(density(res$sims.list$phi[,i]),
         main="marginal posterior",
         xlab=i,
         xlim=c(0,1))
    points(mean(res$sims.list$phi[,i]),
           0,
           col="red",
           pch=16)
}

``
